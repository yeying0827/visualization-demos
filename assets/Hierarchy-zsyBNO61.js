import{h as g,i as f}from"./resquarify-YluFbuPg.js";import{_ as w,f as _,o as A,c as v,F as x,p as y,a as N,b as m}from"./index-s2wsuPQw.js";const p=i=>(y("data-v-13c8b953"),i=i(),N(),i),S=p(()=>m("h3",null,"用SVG+d3绘制层次关系图",-1)),E=p(()=>m("h1",{id:"city-name"},null,-1)),k=p(()=>m("svg",{id:"hierarchy",xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 1600 1600"},null,-1)),B={__name:"Hierarchy",setup(i){_(()=>{const e=document.querySelector("svg#hierarchy"),a="https://s5.ssl.qhres2.com/static/b0695e2dd30daa64.json";(async function(){const r=await(await fetch(a)).json(),c=g(r).sum(n=>1).sort((n,t)=>t.value-n.value),u=f().size([1600,1600]).padding(3)(c);h(e,u);const l=document.querySelector("#city-name");let s;e.addEventListener("mousemove",n=>{let t=n.target;l.innerText=b(t),t.nodeName==="text"&&(t=t.previousSibling),s!==t&&s&&s.setAttribute("fill","rgba(0, 0, 0, 0.2)"),t.setAttribute("fill","rgba(0, 128, 0, 0.1)"),s=t})})()});function h(e,a,{fillStyle:r="rgba(0, 0, 0, 0.2)",textColor:c="white"}={}){const d=a.children,{x:u,y:l,r:s}=a,n=document.createElementNS("http://www.w3.org/2000/svg","circle");if(n.setAttribute("cx",u),n.setAttribute("cy",l),n.setAttribute("r",s),n.setAttribute("fill",r),n.setAttribute("data-name",a.data.name),e.appendChild(n),d){const t=document.createElementNS("http://www.w3.org/2000/svg","g");t.setAttribute("data-name",a.data.name);for(let o=0;o<d.length;o++)h(t,d[o],{fillStyle:r,textColor:c});e.appendChild(t)}else{const t=document.createElementNS("http://www.w3.org/2000/svg","text");t.setAttribute("fill",c),t.setAttribute("font-family","Arial"),t.setAttribute("font-size","1.5rem"),t.setAttribute("text-anchor","middle"),t.setAttribute("x",u),t.setAttribute("y",l),t.setAttribute("data-name",a.data.name);const o=a.data.name;t.textContent=o,e.appendChild(t)}}function b(e){const a=e.getAttribute("data-name");return e.parentNode&&e.parentNode.nodeName==="g"?`${e.parentNode.getAttribute("data-name")} - ${a}`:a}return(e,a)=>(A(),v(x,null,[S,E,k],64))}},C=w(B,[["__scopeId","data-v-13c8b953"]]);export{C as default};
